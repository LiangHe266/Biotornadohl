PACS.ImagePlayer=function(a){if(!(this instanceof PACS.ImagePlayer)){return new PACS.ImagePlayer(a)}this.view=a;this.interval=100;this.setfps(PACS.ImagePlayer.FPS)};PACS.ImagePlayer.FPS=10;PACS.ImagePlayer.prototype.setfps=function(a){a=parseInt(a);if(a<1||a>100){return}this.interval=1000/a};PACS.ImagePlayer.prototype.getfps=function(a){var a=Math.round(1000/this.interval);return a};PACS.ImagePlayer.prototype.next=function(){this.view.next()};PACS.ImagePlayer.prototype.play=function(){if(this.playing){return true}if(!this.view||!this.view.series){msgBox("未加载序列");return false}if(!this.view.series.images.length){msgBox("无图片");return false}if(this.view.series.images.length==1){msgBox("只有一张图片");return false}var c=this;var a={flag:1};var b=function(){if(!a.flag){return}var d=(new Date()).getTime();c.next();d=(new Date()).getTime()-d;if(d+5>=c.interval){d=5}else{d=c.interval-d}setTimeout(b,d)};this.playing=a;setTimeout(b,this.interval);return true};PACS.ImagePlayer.prototype.stop=function(){if(!this.playing){return}this.playing.flag=false;delete this.playing};